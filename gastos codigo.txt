Imports MySql.Data
Imports MySql.Data.MySqlClient
Public Class GastosMontoSueldo
    'opciones de cierre
    Private Sub ButtonCerrar_Click(sender As Object, e As EventArgs)
        Me.Close()
    End Sub
    Private Sub Gastos_Deactivate(sender As Object, e As EventArgs)
        Me.Close()
    End Sub

    ''''''''''''''''Busca gastos'''''''''''''

    Private Sub TextBoxIDCompra_LostFocus(sender As Object, e As EventArgs)
        If IsNumeric(TextBoxIDCompra.Text) Then
            buscagasto()
        ElseIf Not Char.IsControl(TextBoxIDCompra.Text) Then
            MsgBox("Debe ingresar un cliente existente", MsgBoxStyle.Information, "JCapellano")
        End If

    End Sub
    Private Sub buscagasto()
        Try
            ModuloConexion.BDconexion.Open()
            Dim cmdcliente As New MySqlCommand(BDconsulta, BDconexion)
            Dim readcliente As MySqlDataReader
            readcliente = cmdcliente.ExecuteReader()
            If readcliente.Read() Then

                TextBoxIDCompra.Text = readcliente("id_gastos")

                BDopcion = 1 'existe, modificado
            Else
                BDopcion = 0 'El codigo no existe,  lo agrego
            End If

            readcliente.Close()

        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()
        End Try
    End Sub

    ''''''''''''''''Busca aparatos'''''''''''''

    Private Sub TextBoxIdAparato_LostFocus(sender As Object, e As EventArgs)
        If IsNumeric(TextBoxIdAparato.Text) Then
            buscaaparatos()
        ElseIf Not Char.IsControl(TextBoxIdAparato.Text) Then
            MsgBox("Debe ingresar un cliente existente", MsgBoxStyle.Information, "JCapellano")
        End If

    End Sub
    Private Sub buscaaparatos()
        Try
            ModuloConexion.BDconexion.Open()
            Dim cmdcliente As New MySqlCommand(BDconsulta, BDconexion)
            Dim readcliente As MySqlDataReader
            readcliente = cmdcliente.ExecuteReader()
            If readcliente.Read() Then

                TextBoxIdAparato.Text = readcliente("id_aparatos")

                BDopcion = 1 'existe, modificado
            Else
                BDopcion = 0 'El codigo no existe,  lo agrego
            End If

            readcliente.Close()

        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()
        End Try
    End Sub

    ''''''''''''''''Busca sueldos'''''''''''''

    Private Sub TextBoxIdSueldo_LostFocus(sender As Object, e As EventArgs)
        If IsNumeric(TextBoxIdAparato.Text) Then
            buscaasueldo()
        ElseIf Not Char.IsControl(TextBoxIdSueldo.Text) Then
            MsgBox("Debe ingresar un cliente existente", MsgBoxStyle.Information, "JCapellano")
        End If

    End Sub
    Private Sub buscaasueldo()
        Try
            ModuloConexion.BDconexion.Open()
            Dim cmdcliente As New MySqlCommand(BDconsulta, BDconexion)
            Dim readcliente As MySqlDataReader
            readcliente = cmdcliente.ExecuteReader()
            If readcliente.Read() Then

                TextBoxIdSueldo.Text = readcliente("id_sueldo")

                BDopcion = 1 'existe, modificado
            Else
                BDopcion = 0 'El codigo no existe,  lo agrego
            End If

            readcliente.Close()

        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()
        End Try
    End Sub
    '----------------------AMB de Compras/Gastos----------------------------'
    ' Case 1: Agregar Case 2: Modificar Case 3 Eliminar
    Private Sub ambgastos()

        Select Case BDopcion
          '  Case 1 : BDconsulta = "insert into cliente value'( " + TextBoxDNICliente.Text + "','" + TextBoxNombreCliente.Text + "','" + TextBoxApellidoCliente.Text + "','" + DateTimeCliente.Text + "','" + vargenero + "','" + TextBoxTelefonoCliente.Text + "','" + TextBoxCiudadCliente.Text + "','" + ComboBoxModalidadCliente.SelectedValue.ToString + "','" + ComboBoxRutinaCliente.SelectedValue.ToString + ")"
            Case 2 : BDconsulta = "update ventas set idrubro='"
            Case 3 : BDconsulta = "delete from ventas where codigo="
        End Select

        Try

            BDconexion.Open()
            Dim cmdgasto As New MySqlCommand(BDconsulta, BDconexion)
            cmdgasto.ExecuteNonQuery()
            Select Case BDopcion
                Case 0 : MsgBox("Gasto Agregado", MsgBoxStyle.Information)
                Case 1 : MsgBox("Gasto actualizado", MsgBoxStyle.Information)
                Case 2 : MsgBox("Gasto eliminado", MsgBoxStyle.Information)
            End Select

        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()

        End Try
        'Blanquear los texbox .clear y poner el focus
    End Sub

    '----------------------AMB de Aparato----------------------------'
    ' Case 1: Agregar Case 2: Modificar Case 3 Eliminar
    Private Sub ambaparato()

        Select Case BDopcion
            'Case 1 : BDconsulta = "insert into cliente value'( " + TextBoxDNICliente.Text + "','" + TextBoxNombreCliente.Text + "','" + TextBoxApellidoCliente.Text + "','" + DateTimeCliente.Text + "','" + vargenero + "','" + TextBoxTelefonoCliente.Text + "','" + TextBoxCiudadCliente.Text + "','" + ComboBoxModalidadCliente.SelectedValue.ToString + "','" + ComboBoxRutinaCliente.SelectedValue.ToString + ")"
            Case 2 : BDconsulta = "update ventas set idrubro='"
            Case 3 : BDconsulta = "delete from ventas where codigo="
        End Select

        Try

            BDconexion.Open()
            Dim cmdaparato As New MySqlCommand(BDconsulta, BDconexion)
            cmdaparato.ExecuteNonQuery()
            Select Case BDopcion
                Case 0 : MsgBox("Aparato agregado", MsgBoxStyle.Information)
                Case 1 : MsgBox("Aparato actualizado", MsgBoxStyle.Information)
                Case 2 : MsgBox("Aparato eliminado", MsgBoxStyle.Information)
            End Select

        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()

        End Try
        'Blanquear los texbox .clear y poner el focus
    End Sub

    '----------------------AMB de Sueldos----------------------------'
    ' Case 1: Agregar Case 2: Modificar Case 3 Eliminar
    Private Sub ambsueldo()

        Select Case BDopcion
            'Case 1 : BDconsulta = "insert into cliente value'( " + TextBoxDNICliente.Text + "','" + TextBoxNombreCliente.Text + "','" + TextBoxApellidoCliente.Text + "','" + DateTimeCliente.Text + "','" + vargenero + "','" + TextBoxTelefonoCliente.Text + "','" + TextBoxCiudadCliente.Text + "','" + ComboBoxModalidadCliente.SelectedValue.ToString + "','" + ComboBoxRutinaCliente.SelectedValue.ToString + ")"
            Case 2 : BDconsulta = "update ventas set idrubro='"
            Case 3 : BDconsulta = "delete from ventas where codigo="
        End Select

        Try

            BDconexion.Open()
            Dim cmdrubro As New MySqlCommand(BDconsulta, BDconexion)
            cmdrubro.ExecuteNonQuery()
            Select Case BDopcion
                Case 0 : MsgBox("Sueldo agregado", MsgBoxStyle.Information)
                Case 1 : MsgBox("Sueldo actualizado", MsgBoxStyle.Information)
                Case 2 : MsgBox("Sueldo eliminado", MsgBoxStyle.Information)
            End Select

        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()

        End Try
        'Blanquear los texbox .clear y poner el focus
    End Sub



    '--------- Botones de GASTOS -----------'
    Private Sub ButtonAgregarCompra_Click(sender As Object, e As EventArgs)
        If TextBoxDetalleCompra.Text = "" Or TextBoxFechaCompra.Text = "" Or TextBoxIDCompra.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")
        Else
            BDopcion = 0 ' 0 es agregar
            ambgastos()
        End If
    End Sub

    Private Sub ButtonModificarCompra_Click(sender As Object, e As EventArgs)
        If TextBoxDetalleCompra.Text = "" Or TextBoxFechaCompra.Text = "" Or TextBoxIDCompra.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")

        Else
            BDopcion = 1 ' 1 es modificar
            ambgastos()
        End If
    End Sub

    Private Sub ButtonEliminarCompra_Click(sender As Object, e As EventArgs)
        If TextBoxDetalleCompra.Text = "" Or TextBoxFechaCompra.Text = "" Or TextBoxIDCompra.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")

        Else
            BDopcion = 3 ' 3 es eliminar
            ambgastos()
        End If
    End Sub


    '--------- Botones de Sueldo -----------'
    Private Sub ButtonAgregarSueldo_Click(sender As Object, e As EventArgs)
        If TextBoxIdSueldo.Text = "" Or TextBoxMontoSueldo.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")
        Else
            BDopcion = 0 ' 0 es agregar
            ambsueldo()
        End If
    End Sub

    Private Sub ButtonModificarSueldo_Click(sender As Object, e As EventArgs)
        If TextBoxIdSueldo.Text = "" Or TextBoxMontoSueldo.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")

        Else
            BDopcion = 1 ' 1 es modificar
            ambsueldo()
        End If
    End Sub

    Private Sub ButtonEliminarSueldo_Click(sender As Object, e As EventArgs)
        If TextBoxIdSueldo.Text = "" Or TextBoxMontoSueldo.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")

        Else
            BDopcion = 3 ' 3 es eliminar
            ambsueldo()
        End If
    End Sub

    '--------- Botones de Aparato -----------'
    Private Sub ButtonAgregarAparato_Click(sender As Object, e As EventArgs)
        If TextBoxIdAparato.Text = "" Or TextBoxNombreAparato.Text = "" Or TextBoxDetalleAparato.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")
        Else
            BDopcion = 0 ' 0 es agregar
            ambsueldo()
        End If
    End Sub

    Private Sub ButtonModificarAparato_Click(sender As Object, e As EventArgs)
        If TextBoxIdAparato.Text = "" Or TextBoxNombreAparato.Text = "" Or TextBoxDetalleAparato.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")

        Else
            BDopcion = 1 ' 1 es modificar
            ambaparato()
        End If
    End Sub

    Private Sub ButtonEliminarAparato_Click(sender As Object, e As EventArgs)
        If TextBoxIdAparato.Text = "" Or TextBoxNombreAparato.Text = "" Or TextBoxDetalleAparato.Text = "" Then
            MsgBox("Hay datos sin completar, revise los campos")

        Else
            BDopcion = 3 ' 3 es eliminar
            ambaparato()
        End If
    End Sub

    ' ------------------------------LISTA DE gastos---------------------------------'

    Private Sub gastos_Load(sender As Object, e As EventArgs)
        ListViewGastos.View = View.Details
        ListViewGastos.GridLines = True
        ListViewGastos.HideSelection = False
        ListViewGastos.FullRowSelect = True
        ListViewGastos.MultiSelect = False
        ListViewGastos.Items.Clear()
        BDconsulta = "select * from gastos"
        listargastos() ' sub

        ListViewAparatos.View = View.Details
        ListViewAparatos.GridLines = True
        ListViewAparatos.HideSelection = False
        ListViewAparatos.FullRowSelect = True
        ListViewAparatos.MultiSelect = False
        ListViewAparatos.Items.Clear()
        BDconsulta = "select * from gastos"
        listaraparatos() ' sub
    End Sub

    Private Sub listargastos()
        Try
            ModuloConexion.BDconexion.Open()

            Dim cmdrutina As New MySqlCommand(BDconsulta, BDconexion)
            Dim readrutina As MySqlDataReader
            readrutina = cmdrutina.ExecuteReader()
            ListViewGastos.Items.Clear()
            Do While readrutina.Read()
                Dim fila As ListViewItem
                fila = ListViewGastos.Items.Add(readrutina("fecha"))
                fila.SubItems.Add(readrutina("id_gastos"))
                fila.SubItems.Add(readrutina("detalle"))
            Loop
            readrutina.Close()
        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()
        End Try
    End Sub
    Private Sub TextBoxBuscaDetallegastos_TextChanged(sender As Object, e As EventArgs) Handles TextBoxBuscaDetallegastos.TextChanged
        If Char.IsLetter(TextBoxBuscaDetallegastos.Text) Then
            BDconsulta = "select * from gastos where detalle like '" + TextBoxBuscaDetallegastos.Text + "%'order by detalle"
            listargastos()
        ElseIf Not Char.IsControl(TextBoxBuscaDetallegastos.Text) Then
            MsgBox("Debe ingresar una letra")
            TextBoxBuscaDetallegastos.Clear()
        End If
    End Sub
    Private Sub TextBoxBuscaDetallegastos_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TextBoxBuscaDetallegastos.KeyPress
        If Asc(e.KeyChar) = 13 Then 'Cuando el USUARIO presiona ENTER
            BDconsulta = "select * from rutina"
            listargastos()
        End If
    End Sub

    ' ------------------------------LISTA DE aparatos---------------------------------'


    Private Sub listaraparatos()
        Try
            ModuloConexion.BDconexion.Open()

            Dim cmdrutina As New MySqlCommand(BDconsulta, BDconexion)
            Dim readrutina As MySqlDataReader
            readrutina = cmdrutina.ExecuteReader()
            ListViewGastos.Items.Clear()
            Do While readrutina.Read()
                Dim fila As ListViewItem
                fila = ListViewGastos.Items.Add(readrutina("fecha"))
                fila.SubItems.Add(readrutina("id_gastos"))
                fila.SubItems.Add(readrutina("detalle"))
            Loop
            readrutina.Close()
        Catch ex As Exception
            MsgBox(ex.Message.ToString)
        Finally
            BDconexion.Close()
        End Try
    End Sub
    Private Sub TextBoxBuscaDetallegastos_TextChanged(sender As Object, e As EventArgs)
        If Char.IsLetter(TextBoxBuscaDetallegastos.Text) Then
            BDconsulta = "select * from gastos where detalle like '" + TextBoxBuscaDetallegastos.Text + "%'order by detalle"
            listargastos()
        ElseIf Not Char.IsControl(TextBoxBuscaDetallegastos.Text) Then
            MsgBox("Debe ingresar una letra")
            TextBoxBuscaDetallegastos.Clear()
        End If
    End Sub
    Private Sub TextBoxBuscaDetallegastos_KeyPress(sender As Object, e As KeyPressEventArgs)
        If Asc(e.KeyChar) = 13 Then 'Cuando el USUARIO presiona ENTER
            BDconsulta = "select * from rutina"
            listargastos()
        End If
    End Sub
End Class